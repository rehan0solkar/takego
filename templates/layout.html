<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}Canteen System{% endblock %}</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='common.css') }}">
</head>
<body>

<!-- ðŸ”” FLASH MESSAGE (CENTER) -->
{% with messages = get_flashed_messages(with_categories=true) %}
  {% if messages %}
    <div
      id="flash-container"
      data-messages='{{ messages | tojson | safe }}'>
    </div>
  {% endif %}
{% endwith %}


<!-- ðŸ”¹ MAIN CONTENT -->
{% block content %}{% endblock %}
<!-- ðŸ§  AUTO HIDE FLASH -->
 
<script>
function showToast(message, category = "info") {
  let toast = document.getElementById("toast");

  if (!toast) {
    toast = document.createElement("div");
    toast.id = "toast";
    toast.className = "toast hidden";
    document.body.appendChild(toast);
  }

  toast.innerText = message;
  toast.className = `toast ${category}`;
  
  // show
  toast.classList.remove("hidden");

  // auto hide
  setTimeout(() => {
    toast.classList.add("hidden");
  }, 2500);
}
window.addEventListener("DOMContentLoaded", () => {
  const flash = document.getElementById("flash-container");
  if (!flash) return;

  let messages = [];
  try {
    messages = JSON.parse(flash.dataset.messages || "[]");
  } catch (e) {
    console.error("Flash parse error", e);
    return;
  }

  messages.forEach(([category, message], index) => {
    setTimeout(() => {
      showToast(message, category);
    }, index * 300); // slight stagger
  });
});
</script>

</body>
</html>
